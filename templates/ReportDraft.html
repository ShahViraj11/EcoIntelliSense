<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>EcoIntelliSense Report</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='ReportDraftStyle.css') }}">
    <style>
        body {
            font-family: 'Roboto', sans-serif;
            line-height: 1.6;
            color: #333;
        }
        .header {
            background: #f4f4f4;
            padding: 20px 0;
            text-align: center;
        }
        .header img {
            max-height: 50px;
        }
        .header h1 {
            margin: 10px 0;
        }
        .row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
        }
        .column {
            flex: 1;
            padding: 0 20px;
        }
        .energy-analysis {
            margin-bottom: 20px;
        }
        .title-text {
            text-align: center;
            margin-top: 50px;
        }
        .unsafe-air-quality {
            color: red;
        }
    </style>
</head>
<body>

<div class="header">
    <img src="{{ url_for('static', filename='images/logo.png') }}" alt="Logo">
    <div class="logo-text">EcoIntelliSense</div>
    <h1>Sustainability Dashboard</h1>
</div>

<div class="row">
  <!-- Left Column -->
  <div class="column">
      <h2>Project Overview</h2>
      <p><b>Location:</b> {{ data['location'] }}</p>
      <p><b>Near Water:</b> {{ 'Yes' if data['near_water'] else 'No' }}</p>
      <h3>Labor and Cost</h3>
      <ul>
          {% for item, cost in data['labor_cost'].items() %}
          <li>{{ item }}: {{ cost }}</li>
          {% endfor %}
      </ul>
  </div>

  <!-- Right Column -->
  <div class="column">
      <h2>Site Details</h2>
      <p><b>Area:</b> {{ data['area'] }} m<sup>2</sup></p>
      <p><b>Elevation:</b> {{ data['elevation'] }} m</p>
  </div>
</div>

<!-- Map -->
<div id="map" style="text-align: center;">
    <h2>Location Map</h2>
        <iframe
        width="450"
        height="250"
        frameborder="0"
        style="border:0"
        referrerpolicy="no-referrer-when-downgrade"
        src="https://www.google.com/maps/embed/v1/view?key=AIzaSyDu9WmzWfQnxsqJhWLE8CTMlSYB0VRUrkg
        &center={{ data['coordinates'][0] }},{{ data['coordinates'][1] }}
        &zoom=15
        &maptype=roadmap"
        allowfullscreen>
        </iframe>
</div>

<!-- Sustainability Scale -->
<div class="sustainability-scale">
    <h2>Sustainability Scale</h2>
    {{ data['sustainability_scale'] }}
</div>

<!-- Solar Energy Analysis -->
<div class="energy-analysis" id="solar-energy-analysis">
    <h2>Solar Energy Analysis</h2>
    <div id="solar-graph"></div>
    <script>
        var solarData = [{ y: {{ data['solar']|tojson }}, type: "bar" }];

        var solarLayout = {
            title: "Solar Energy Analysis",
            xaxis: {
                tickvals: [0,1,2,3,4,5,6,7,8,9,10,11,12],
                ticktext: ["Jan", "Feb", "Mar", "Apr", "May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]
            }
        };

        Plotly.newPlot("solar-graph", solarData, solarLayout, { displaylogo: false });
    </script>
</div>

<!-- Wind Energy Analysis -->
<div class="energy-analysis" id="wind-energy-analysis">
    <h2>Wind Energy Analysis</h2>
    <div id="wind-graph"></div>
    <script>
        var C = {{ data['wind'] }};
        
        var xValues = Array.from({length: 12}, (_, i) => i);
        var intersectionPoint = Math.ceil((1 / C) * Math.log(1 + 1));  // Calculate intersection point
    
        var y1Values = xValues.map(x => (1 / C) * Math.log(x + 1));  // Avoid log(0)
        var y2Values = xValues.map(x => (1 / C) * x);
    
        var windTrace1 = {
            x: xValues,
            y: y1Values,
            type: 'scatter',
            mode: 'lines',
            name: 'Wind'
        };
    
        var windTrace2 = {
            x: xValues,
            y: y2Values,
            type: 'scatter',
            mode: 'lines',
            name: 'Non-Renewable Energy'
        };
    
        var windLayout = {
            title: 'Wind Energy Analysis',
            xaxis: {
                tickvals: xValues,
                ticktext: xValues.map(val => (val + intersectionPoint) % 12 + 1) // Adjust ticks based on intersection point
            }   
        };
    
        var windData = [windTrace1, windTrace2];
    
        Plotly.newPlot('wind-graph', windData, windLayout, {displaylogo: false});
    </script>
</div>

<!-- Air Quality Index -->
<div>
    <h2>Air Quality Index</h2>
    <p class="{{ 'unsafe-air-quality' if data['air_quality_index'] > 100 else '' }}">
        {{ data['air_quality_index'] }}
    </p>
</div>

<!-- Warnings -->
<div>
    <h2>Warnings</h2>
    <ul>
        {% if data['near_water'] %}
        <li>Water body nearby</li>
        {% else %}
        <li>No warnings detected</li>
        {% endif %}
    </ul>
</div>

<!-- Footer -->
<div class="title-text">
    <div>
        <h5>Made by Viraj, Amrit, Sid, and Lance</h5>
        <h5>@ Boilermake XI 2024</h5>
    </div>
</div>

<script>
    // JavaScript for rendering graphs
</script>

</body>
</html>
